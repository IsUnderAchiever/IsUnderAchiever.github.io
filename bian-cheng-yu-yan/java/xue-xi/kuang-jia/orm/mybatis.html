<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>MyBatis - 折影轻梦</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="折影轻梦,Mixcm,轻惋,觅漫者,小舒同学,Xiaoshu,Nexmoe,产品,Meteor,探索者小舒,伴学OS1,Theme,Design,Product">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
    <meta name="description" content="MyBatis 使用以下sql新建表(我使用的是oracle数据库，而非mysql) 使用之前提过的自动生成方式生成对应的实体类和mapper  -- 创建用户表create table tb_people(    id     varchar2(50) primary key,    name   varchar2(30),    gender number(1),    age    numb">
<meta property="og:type" content="article">
<meta property="og:title" content="MyBatis">
<meta property="og:url" content="https://nexmoe.com/bian-cheng-yu-yan/java/xue-xi/kuang-jia/orm/mybatis.html">
<meta property="og:site_name" content="折影轻梦">
<meta property="og:description" content="MyBatis 使用以下sql新建表(我使用的是oracle数据库，而非mysql) 使用之前提过的自动生成方式生成对应的实体类和mapper  -- 创建用户表create table tb_people(    id     varchar2(50) primary key,    name   varchar2(30),    gender number(1),    age    numb">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152332452.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152332762.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333538.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333012.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333925.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333203.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333832.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333837.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333222.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334376.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333231.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333771.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333000.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333713.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334236.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334627.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334106.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334214.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334856.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334047.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334497.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334867.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334703.png">
<meta property="article:published_time" content="2023-03-19T00:00:00.000Z">
<meta property="article:modified_time" content="2024-06-01T14:32:53.518Z">
<meta property="article:author" content="折影轻梦">
<meta property="article:tag" content="MyBatis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152332452.png">
    
<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1717252409423">
    
    <link rel="stylesheet" href="/css/style.css?v=1717252409423">

    
        
            <link rel="stylesheet" href="/custom.css?v=1717252409423">
        
    

    
<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>


    <script async src="/js/app.js?v=1717252409423"></script>
    
     

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>

<meta name="generator" content="Hexo 6.3.0"></head>

<body class="mdui-drawer-body-left">
    <div id="nexmoe-background">
        <div class="nexmoe-bg" 
            style="background-image: url(https://raw.githubusercontent.com/IsUnderAchiever/blog-img/master/about/202309161102206.jpg)"
        ></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="折影轻梦" class="mdui-btn mdui-btn-icon"><img src="https://raw.githubusercontent.com/IsUnderAchiever/blog-img/master/about/202309161102017.jpg" alt="折影轻梦"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="折影轻梦">
            <img src="https://raw.githubusercontent.com/IsUnderAchiever/blog-img/master/about/202309161102017.jpg" alt="折影轻梦" alt="折影轻梦">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>168</div>
        <div><span>标签</span>60</div>
        <div><span>分类</span>61</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/life.html" title="我的生活">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的生活
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about.html" title="关于博主">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博主
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
        
            
            <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
        
            <form id="search_form">
                <label><input class="st-default-search-input" id="search_value" name="q" type="search" placeholder="搜索" style="
                    font-size: 15px !important;
                    height: 56px !important;
                    background-image: none;
                "></label>
            </form>
         
    </div>
</div>


	<script async src="/js/search.js?v=1717252409423"></script>



        
            
            <div class="nexmoe-widget-wrap">
	<div class="nexmoe-widget nexmoe-social">
		<a
			class="mdui-ripple"
			href="http://wpa.qq.com/msgrd?v=3&uin=938798576&site=qq&menu=yes"
			target="_blank"
			mdui-tooltip="{content: 'QQ群'}"
			style="
				color: rgb(249, 174, 8);
				background-color: rgba(249, 174, 8, .1);
			"
		>
			<i
				class="nexmoefont icon-QQ"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://space.bilibili.com/477448861/"
			target="_blank"
			mdui-tooltip="{content: '哔哩哔哩'}"
			style="
				color: rgb(231, 106, 141);
				background-color: rgba(231, 106, 141, .1);
			"
		>
			<i
				class="nexmoefont icon-bilibili"
			></i> </a
		>
	</div>
</div>

        
            
            
            
            
            
            
    </aside>
    <div class="nexmoe-copyright">
        &copy; 2024 折影轻梦
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
    <div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover"> 
            <img src="https://raw.githubusercontent.com/IsUnderAchiever/blog-img/master/about/202309161102206.jpg" alt="MyBatis" loading="lazy">
            <h1>MyBatis</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2023年03月19日</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/ORM%E6%A1%86%E6%9E%B6/">ORM框架</a>
        
        
    </div>
    
    
    
    
    
</div>

    <h1 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h1><blockquote>
<p>使用以下sql新建表<code>(我使用的是oracle数据库，而非mysql)</code></p>
<p>使用之前提过的自动生成方式生成对应的实体类和mapper</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建用户表</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> tb_people<br>(<br>    id     varchar2(<span class="hljs-number">50</span>) <span class="hljs-keyword">primary</span> key,<br>    name   varchar2(<span class="hljs-number">30</span>),<br>    gender number(<span class="hljs-number">1</span>),<br>    age    number(<span class="hljs-number">3</span>) <span class="hljs-keyword">check</span> ( age <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> )<br>);<br><span class="hljs-comment">-- 创建手机表</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> tb_phone<br>(<br>    id    varchar2(<span class="hljs-number">50</span>) <span class="hljs-keyword">primary</span> key,<br>    name  varchar2(<span class="hljs-number">20</span>),<br>    brand varchar2(<span class="hljs-number">20</span>),<br>    price number(<span class="hljs-number">10</span>, <span class="hljs-number">2</span>)<br>);<br><span class="hljs-comment">-- 创建 用户-手机详情表</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> tb_people_phone_detail<br>(<br>    people_id varchar2(<span class="hljs-number">50</span>),<br>    phone_id  varchar2(<span class="hljs-number">50</span>),<br>    <span class="hljs-keyword">primary</span> key (people_id, phone_id)<br>);<br><span class="hljs-keyword">commit</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> tb_people;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> tb_phone;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> tb_people_phone_detail;<br><span class="hljs-comment">-- 添加表注释</span><br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">table</span> tb_people <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;用户表&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">table</span> tb_phone <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;手机表&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">table</span> tb_people_phone_detail <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;用户-手机详情表&#x27;</span>;<br><span class="hljs-comment">-- 添加字段注释</span><br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">column</span> tb_people.id <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;用户主键&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">column</span> tb_people.name <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;用户姓名&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">column</span> tb_people.gender <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;用户性别&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">column</span> tb_people.age <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;用户年龄&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">column</span> tb_phone.id <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;手机主键&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">column</span> tb_phone.name <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;手机名称&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">column</span> tb_phone.brand <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;手机品牌&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">column</span> tb_phone.price <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;手机价格&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">column</span> tb_people_phone_detail.people_id <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;用户主键&#x27;</span>;<br>comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">column</span> tb_people_phone_detail.phone_id <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;手机主键&#x27;</span>;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>添加依赖</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--mybatis--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.10<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!--oracle--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.oracle.database.jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>ojdbc6<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>11.2.0.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!--log4j--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.17<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!--junit--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.13.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!-- hutool --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.hutool<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hutool-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.8.15<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight properties"><table><tr><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># 数据库驱动：</span><br><span class="hljs-attr">jdbc.driver</span>=<span class="hljs-string">oracle.jdbc.driver.OracleDriver</span><br><span class="hljs-comment"># 数据库连接地址</span><br><span class="hljs-attr">jdbc.url</span>=<span class="hljs-string">jdbc:oracle:thin:@localhost:1521:orcl</span><br><span class="hljs-comment"># 数据库用户名&amp;密码：</span><br><span class="hljs-attr">jdbc.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">jdbc.password</span>=<span class="hljs-string">123456</span><br></code></pre></td></tr></table></figure>
<figure class="highlight properties"><table><tr><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># 控制台打印</span><br><span class="hljs-attr">log4j.rootLogger</span>=<span class="hljs-string">debug, stdout</span><br><span class="hljs-attr">log4j.logger.org.mybatis.example.BlogMapper</span>=<span class="hljs-string">TRACE</span><br><span class="hljs-attr">log4j.appender.stdout</span>=<span class="hljs-string">org.apache.log4j.ConsoleAppender</span><br><span class="hljs-attr">log4j.appender.stdout.Target</span>=<span class="hljs-string">System.out</span><br><span class="hljs-attr">log4j.appender.stdout.layout</span>=<span class="hljs-string">org.apache.log4j.PatternLayout</span><br><span class="hljs-attr">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="hljs-string">%d&#123;ABSOLUTE&#125; %5p %c&#123;1&#125;:%L - %m%n</span><br><span class="hljs-comment"># 输出到文件</span><br><span class="hljs-attr">log4j.appender.file</span>=<span class="hljs-string">org.apache.log4j.ConsoleAppender</span><br><span class="hljs-attr">log4j.appender.file.File</span>=<span class="hljs-string">C:\Users\tong\Desktop\log4j</span><br><span class="hljs-attr">log4j.appender.file.layout</span>=<span class="hljs-string">org.apache.log4j.PatternLayout</span><br><span class="hljs-attr">log4j.appender.file.layout.ConversionPattern</span>=<span class="hljs-string">%d&#123;ABSOLUTE&#125; %5p %c&#123;1&#125;:%L - %m%n</span><br></code></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">configuration</span> <span class="hljs-keyword">PUBLIC</span></span><br><span class="hljs-meta">        <span class="hljs-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--设置文件所在路径--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;jdbc.properties&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- 打印sql日志 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--别名配置--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.example.domain&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--指定包--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.example.mapper&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h2 id="和-的区别"><a href="#和-的区别" class="headerlink" title="#{}和${}的区别"></a><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152332452.png" alt="项目目录结构" data-caption="项目目录结构" loading="lazy"><br><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ApplicationTest</span> &#123;<br>    <span class="hljs-keyword">private</span> SqlSession session;<br>    <span class="hljs-meta">@Before</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;mybatis-config.xml&quot;</span>;<br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> Resources.getResourceAsStream(resource);<br>        <span class="hljs-type">SqlSessionFactory</span> <span class="hljs-variable">sqlSessionFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBuilder</span>().build(inputStream);<br>        session=sqlSessionFactory.openSession();<br>    &#125;<br>    <span class="hljs-meta">@After</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destory</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">// 提交事务，并释放资源</span><br>        session.commit();<br>        session.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br>#{}和${}的区别</h2><h2 id="如果使用-，他是预编译的sq可以防止SQL注入攻击如果使用-，他是直接把参数值拿来进行拼接，这样会有SQL注入的危险SQL片段抽取"><a href="#如果使用-，他是预编译的sq可以防止SQL注入攻击如果使用-，他是直接把参数值拿来进行拼接，这样会有SQL注入的危险SQL片段抽取" class="headerlink" title="如果使用#{}，他是预编译的sq可以防止SQL注入攻击如果使用${}，他是直接把参数值拿来进行拼接，这样会有SQL注入的危险SQL片段抽取"></a>如果使用#{}，他是预编译的sq可以防止SQL注入攻击<br>如果使用${}，他是直接把参数值拿来进行拼接，这样会有SQL注入的危险<br>SQL片段抽取</h2><h2 id="mapper-xml-标签"><a href="#mapper-xml-标签" class="headerlink" title="mapper.xml 标签"></a><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152332762.png" alt="image-20230319165154581" data-caption="image-20230319165154581" loading="lazy"><br><figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.example.mapper.PeopleMapper&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;BaseResultMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;ID&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;VARCHAR&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;NAME&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;VARCHAR&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;GENDER&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;DECIMAL&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;gender&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;AGE&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;DECIMAL&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;age&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">sql</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>&gt;</span><br>        ID<br>        , NAME, GENDER, AGE<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">sql</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 查询全部用户 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>        select<br>        <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>        from tb_people<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><br>mapper.xml 标签</h2><ol>
<li>if</li>
<li>trim</li>
<li>where</li>
<li>set</li>
<li>foreach</li>
<li>choose<blockquote>
<p>if</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>    select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>    from tb_people<br>    where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name!=null&quot;</span>&gt;</span><br>        and name = #&#123;name&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>trim</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 清除前缀 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>    select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>    from tb_people<br>    <span class="hljs-tag">&lt;<span class="hljs-name">trim</span> <span class="hljs-attr">prefixOverrides</span>=<span class="hljs-string">&quot;and|or&quot;</span>&gt;</span><br>        and<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">trim</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 清除后缀 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>    select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>    from tb_people<br>    <span class="hljs-tag">&lt;<span class="hljs-name">trim</span> <span class="hljs-attr">suffixOverrides</span>=<span class="hljs-string">&quot;like&quot;</span>&gt;</span><br>        where 1=1 like<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">trim</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 添加前缀 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>    select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>    from tb_people<br>    <span class="hljs-tag">&lt;<span class="hljs-name">trim</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">&quot;where&quot;</span>&gt;</span><br>        1=1<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">trim</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 添加后缀 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>    select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>    from tb_people<br>    <span class="hljs-tag">&lt;<span class="hljs-name">trim</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">&quot;1=1&quot;</span>&gt;</span><br>        where<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">trim</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 综合使用 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>    select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>    from tb_people<br>    <span class="hljs-tag">&lt;<span class="hljs-name">trim</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">&quot;where&quot;</span> <span class="hljs-attr">prefixOverrides</span>=<span class="hljs-string">&quot;and|or&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;id!=null&quot;</span>&gt;</span><br>            id = #&#123;id&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name!=null&quot;</span>&gt;</span><br>            and name = #&#123;name&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">trim</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>where</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--where 标签等价于 trim prefix=&quot;where&quot; prefixOverrides=&quot;and|or&quot;--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>    from tb_people<br>    <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;id!=null&quot;</span>&gt;</span><br>            and id = #&#123;id&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name!=null&quot;</span>&gt;</span><br>            and name = #&#123;name&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>set</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- set 标签等价于 trim prefix=&quot;set&quot; suffixOverrides=&quot;,&quot; --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updatePeople&quot;</span>&gt;</span><br>    update people<br>    <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name!=null&quot;</span>&gt;</span><br>            name = #&#123;name&#125;,<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;gender!=null&quot;</span>&gt;</span><br>            gender = #&#123;gender&#125;,<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span><br>    where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>foreach</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> people <span class="hljs-keyword">where</span> id <span class="hljs-keyword">in</span> (?,?,?,?);<br></code></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--ids 为接口内接收的参数名称--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>    select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>    from tb_people<br>    <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;ids&quot;</span> <span class="hljs-attr">open</span>=<span class="hljs-string">&quot;id in (&quot;</span> <span class="hljs-attr">close</span>=<span class="hljs-string">&quot;)&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;,&quot;</span>&gt;</span><br>            #&#123;id&#125;<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>choose</p>
<p>类似于java的switch、case、default</p>
<ol>
<li>如果id不为空，则通过id查询</li>
<li>如果id为空，名称不为空，则通过名称查询</li>
<li>如果id和名称都为空，则查询id为3的用户</li>
</ol>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>    select<br>    <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>    from tb_people<br>    <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">choose</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">when</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;id!=null&quot;</span>&gt;</span><br>                id = #&#123;id&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">when</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">when</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;name!=null&quot;</span>&gt;</span><br>                name = #&#123;name&#125;<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">when</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">otherwise</span>&gt;</span><br>                id = 3<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">otherwise</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">choose</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>
字段映射问题</li>
</ol>
<hr>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 先插入几条数据</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addPeople</span><span class="hljs-params">()</span>&#123;<br>    PeopleMapper peopleMapper=session.getMapper(PeopleMapper.class);<br>    peopleMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">People</span>(IdUtil.simpleUUID(),<span class="hljs-string">&quot;李华&quot;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">15</span>));<br>    peopleMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">People</span>(IdUtil.simpleUUID(),<span class="hljs-string">&quot;张三&quot;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">25</span>));<br>    peopleMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">People</span>(IdUtil.simpleUUID(),<span class="hljs-string">&quot;王大锤&quot;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">26</span>));<br>    peopleMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">People</span>(IdUtil.simpleUUID(),<span class="hljs-string">&quot;翠花&quot;</span>,<span class="hljs-number">0</span>,<span class="hljs-number">18</span>));<br>&#125;<br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addPhone</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">PhoneMapper</span> <span class="hljs-variable">phoneMapper</span> <span class="hljs-operator">=</span> session.getMapper(PhoneMapper.class);<br>    phoneMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Phone</span>(IdUtil.simpleUUID(),<span class="hljs-string">&quot;k30&quot;</span>,<span class="hljs-string">&quot;红米&quot;</span>,BigDecimal.valueOf(<span class="hljs-number">3000</span>)));<br>    phoneMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Phone</span>(IdUtil.simpleUUID(),<span class="hljs-string">&quot;note 11t&quot;</span>,<span class="hljs-string">&quot;红米&quot;</span>,BigDecimal.valueOf(<span class="hljs-number">4000</span>)));<br>    phoneMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Phone</span>(IdUtil.simpleUUID(),<span class="hljs-string">&quot;mate 50&quot;</span>,<span class="hljs-string">&quot;华为&quot;</span>,BigDecimal.valueOf(<span class="hljs-number">5000</span>)));<br>&#125;<br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addPeoplePhoneDetail</span><span class="hljs-params">()</span>&#123;<br>    PeoplePhoneDetailMapper peoplePhoneDetailMapper=session.getMapper(PeoplePhoneDetailMapper.class);<br>    peoplePhoneDetailMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PeoplePhoneDetail</span>(<span class="hljs-string">&quot;b0e11aed0db6412ebf342dc9676b5ba6&quot;</span>,<span class="hljs-string">&quot;1cff22c9409c44fd8524ea9c4d6e3385&quot;</span>));<br>    peoplePhoneDetailMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PeoplePhoneDetail</span>(<span class="hljs-string">&quot;b0e11aed0db6412ebf342dc9676b5ba6&quot;</span>,<span class="hljs-string">&quot;639153d49e0d4d33af43e4d4534b1631&quot;</span>));<br>    peoplePhoneDetailMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PeoplePhoneDetail</span>(<span class="hljs-string">&quot;6f226961637346ec82499567122e00ea&quot;</span>,<span class="hljs-string">&quot;2b1edb7c93f04d7d91fc8200378a2c94&quot;</span>));<br>    peoplePhoneDetailMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PeoplePhoneDetail</span>(<span class="hljs-string">&quot;672b002417de41d184d7d14f31660e9f&quot;</span>,<span class="hljs-string">&quot;639153d49e0d4d33af43e4d4534b1631&quot;</span>));<br>    peoplePhoneDetailMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PeoplePhoneDetail</span>(<span class="hljs-string">&quot;de32b418f26e475aa68ef2f692e58cb6&quot;</span>,<span class="hljs-string">&quot;1cff22c9409c44fd8524ea9c4d6e3385&quot;</span>));<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>如 数据库 people_id 字段无法映射到 java 里peopleId，即<code>驼峰命名法</code><br>解决方法1：在mybatis里开启驼峰命名的自动映射</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span></span><br><span class="hljs-tag">    &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">打印sql日志</span> <span class="hljs-attr">--</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span><br>    <span class="hljs-comment">&lt;!-- 配置驼峰映射 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>解决方法2：在sql里配置别名</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> people_id peopleId,phone_id phoneId <span class="hljs-keyword">from</span> tb_people_phone_detail<br></code></pre></td></tr></table></figure>
<blockquote>
<p>解决方法3：自定义映射规则<code>(继承映射规则)</code><br>问题<br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333538.png" alt="image-20230319150511655" data-caption="image-20230319150511655" loading="lazy"><br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333012.png" alt="image-20230319150532911" data-caption="image-20230319150532911" loading="lazy"><br>正确展示<br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333925.png" alt="image-20230319150634576" data-caption="image-20230319150634576" loading="lazy"><br>多表查询</p>
</blockquote>
<hr>
<h3 id="一对一"><a href="#一对一" class="headerlink" title="一对一"></a>一对一</h3><h2 id="可以看到这是一个一对多的关系，但是就以张三作为演示，张三的关系是一对一的-首先需要明确通过什么来查什么？-我们现在需要通过使用者来查询他的手机，所以需要在使用者的属性里新建一个手机-别忘了生成对应属性的get、set等方法哦-关联查询-先测试一下sql是否正确写法1写法2-以上两种写法都能查询到结果-一对多-接下来测试一对多，将Phone-phone-改成List-phones-分步查询-分布查询也可以完成以上操作-我们分为两个select操作-1-查找到对应的手机id-可能是多部-2-根据手机id查找到对应的手机-在方法上右键，选择copy-reference将id作为参数传给findRoleByUserId方法-查看打印的日志-可以看到执行了两个sql分布查询里的按需加载"><a href="#可以看到这是一个一对多的关系，但是就以张三作为演示，张三的关系是一对一的-首先需要明确通过什么来查什么？-我们现在需要通过使用者来查询他的手机，所以需要在使用者的属性里新建一个手机-别忘了生成对应属性的get、set等方法哦-关联查询-先测试一下sql是否正确写法1写法2-以上两种写法都能查询到结果-一对多-接下来测试一对多，将Phone-phone-改成List-phones-分步查询-分布查询也可以完成以上操作-我们分为两个select操作-1-查找到对应的手机id-可能是多部-2-根据手机id查找到对应的手机-在方法上右键，选择copy-reference将id作为参数传给findRoleByUserId方法-查看打印的日志-可以看到执行了两个sql分布查询里的按需加载" class="headerlink" title="&gt; 可以看到这是一个一对多的关系，但是就以张三作为演示，张三的关系是一对一的&gt;&gt; 首先需要明确通过什么来查什么？&gt;&gt; 我们现在需要通过使用者来查询他的手机，所以需要在使用者的属性里新建一个手机&gt;&gt; 别忘了生成对应属性的get、set等方法哦#### 关联查询&gt; 先测试一下sql是否正确写法1写法2&gt; 以上两种写法都能查询到结果### 一对多&gt; 接下来测试一对多，将Phone phone 改成List&lt;Phone&gt; phones### 分步查询&gt; 分布查询也可以完成以上操作&gt;&gt; 我们分为两个select操作&gt;&gt; 1.  查找到对应的手机id(可能是多部)&gt; 2.  根据手机id查找到对应的手机&gt; 在方法上右键，选择copy reference将id作为参数传给findRoleByUserId方法&gt; 查看打印的日志&gt;&gt; 可以看到执行了两个sql分布查询里的按需加载"></a><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333203.png" alt="一对一查询" data-caption="一对一查询" loading="lazy"><br>&gt; 可以看到这是一个一对多的关系，但是就<code>以张三作为演示</code>，张三的关系是一对一的<br>&gt;<br>&gt; 首先需要明确通过什么来查什么？<br>&gt;<br>&gt; 我们现在需要通过使用者来查询他的手机，所以需要在使用者的属性里新建一个<code>手机</code><br>&gt;<br>&gt; 别忘了生成对应属性的get、set等方法哦<br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333832.png" alt="image-20230319150918664" data-caption="image-20230319150918664" loading="lazy"><br>#### 关联查询<br>&gt; 先测试一下sql是否正确<br><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> tb_people.id &quot;id&quot;,<br>       tb_people.name &quot;name&quot;,<br>       tb_people.gender &quot;gender&quot;,<br>       tb_people.age &quot;age&quot;,<br>       tb_phone.id    &quot;phone_id&quot;,<br>       tb_phone.name  &quot;phone_name&quot;,<br>       tb_phone.brand &quot;phone_brand&quot;,<br>       tb_phone.price &quot;phone_price&quot;<br><span class="hljs-keyword">from</span> tb_people,<br>     tb_people_phone_detail,<br>     tb_phone<br><span class="hljs-keyword">where</span> tb_people.id <span class="hljs-operator">=</span> tb_people_phone_detail.people_id(<span class="hljs-operator">+</span>)<br>  <span class="hljs-keyword">and</span> tb_people_phone_detail.phone_id <span class="hljs-operator">=</span> tb_phone.id(<span class="hljs-operator">+</span>)<br>  <span class="hljs-keyword">and</span> tb_people.id <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;6f226961637346ec82499567122e00ea&#x27;</span><br></code></pre></td></tr></table></figure><br><strong><code>写法1</code></strong><br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333837.png" alt="image-20230319153350899" data-caption="image-20230319153350899" loading="lazy"><br><strong><code>写法2</code></strong><br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333222.png" alt="image-20230319153645683" data-caption="image-20230319153645683" loading="lazy"><br>&gt; 以上两种写法都能查询到结果<br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334376.png" alt="image-20230319153711710" data-caption="image-20230319153711710" loading="lazy"><br>### 一对多<br>&gt; 接下来测试一对多，将<code>Phone phone</code> 改成<code>List&lt;Phone&gt; phones</code><br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333231.png" alt="image-20230319153856569" data-caption="image-20230319153856569" loading="lazy"><br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333771.png" alt="image-20230319154549831" data-caption="image-20230319154549831" loading="lazy"><br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333000.png" alt="image-20230319154452735" data-caption="image-20230319154452735" loading="lazy"><br><figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.example.mapper.PeopleMapper&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;BaseResultMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;ID&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;VARCHAR&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;NAME&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;VARCHAR&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;GENDER&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;DECIMAL&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;gender&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;AGE&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;DECIMAL&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;age&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">sql</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>&gt;</span><br>        ID<br>        , NAME, GENDER, AGE<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">sql</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;PeoplePhonesResultMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;BaseResultMap&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;phones&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;com.example.domain.Phone&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phone_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phone_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phone_brand&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;brand&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phone_price&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;price&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 根据用户id查询 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeopleWithPhones&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>        select tb_people.id &quot;id&quot;,<br>               tb_people.name &quot;name&quot;,<br>               tb_people.gender &quot;gender&quot;,<br>               tb_people.age &quot;age&quot;,<br>               tb_phone.id    &quot;phone_id&quot;,<br>               tb_phone.name  &quot;phone_name&quot;,<br>               tb_phone.brand &quot;phone_brand&quot;,<br>               tb_phone.price &quot;phone_price&quot;<br>        from tb_people,<br>             tb_people_phone_detail,<br>             tb_phone<br>        where tb_people.id = tb_people_phone_detail.people_id(+)<br>          and tb_people_phone_detail.phone_id = tb_phone.id(+)<br>          and tb_people.id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 查询全部用户 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectPeople&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.example.domain.People&quot;</span>&gt;</span><br>        select<br>        <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>/&gt;</span><br>        from tb_people<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><br>### 分步查询<br>&gt; 分布查询也可以完成以上操作<br>&gt;<br>&gt; 我们分为两个select操作<br>&gt;<br>&gt; 1.  查找到对应的手机id<code>(可能是多部)</code><br>&gt; 2.  根据手机id查找到对应的手机<br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152333713.png" alt="image-20230319160711641" data-caption="image-20230319160711641" loading="lazy"><br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334236.png" alt="image-20230319160722486" data-caption="image-20230319160722486" loading="lazy"><br>&gt; 在方法上右键，选择copy reference<br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334627.png" alt="image-20230319155018277" data-caption="image-20230319155018277" loading="lazy"><br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334106.png" alt="image-20230319160822156" data-caption="image-20230319160822156" loading="lazy"><br><strong>将id作为参数传给findRoleByUserId方法</strong><br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334214.png" alt="image-20230319160850613" data-caption="image-20230319160850613" loading="lazy"><br>&gt; 查看打印的日志<br>&gt;<br>&gt; 可以看到执行了两个sql<br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334856.png" alt="image-20230319161044940" data-caption="image-20230319161044940" loading="lazy"><br>分布查询里的<code>按需加载</code></h2><h2 id="这里我们只打印输出了人的id，并没有涉及到手机的信息，所以只执行了一个sql语句分页查询"><a href="#这里我们只打印输出了人的id，并没有涉及到手机的信息，所以只执行了一个sql语句分页查询" class="headerlink" title="&gt; 这里我们只打印输出了人的id，并没有涉及到手机的信息，所以只执行了一个sql语句分页查询"></a><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334047.png" alt="image-20230319161232719" data-caption="image-20230319161232719" loading="lazy"><br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334497.png" alt="image-20230319161346819" data-caption="image-20230319161346819" loading="lazy"><br>&gt; 这里我们只打印输出了人的id，并没有涉及到手机的信息，所以只执行了一个sql语句<br>分页查询</h2><figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--mybatis--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.10<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--oracle--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.oracle.database.jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>ojdbc6<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>11.2.0.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--log4j--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.17<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--junit--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.13.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--hutool--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.hutool<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hutool-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.8.15<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--lombok--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--pagehelper--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.pagehelper<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>pagehelper<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>pagehelper的版本不要太高，否则匹配会出现问题<br><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334867.png" alt="image-20230319161600953" data-caption="image-20230319161600953" loading="lazy"></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">PeopleMapper</span> <span class="hljs-variable">peopleMapper</span> <span class="hljs-operator">=</span> session.getMapper(PeopleMapper.class);<br>    <span class="hljs-comment">// 设置分页查询参数</span><br>    PageHelper.startPage(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);<br>    List&lt;People&gt; peopleList = peopleMapper.selectPeople();<br>    PageInfo&lt;People&gt; pageInfo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageInfo</span>&lt;&gt;(peopleList);<br>    <span class="hljs-comment">// 总条数</span><br>    <span class="hljs-type">long</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> pageInfo.getTotal();<br>    <span class="hljs-comment">// 总页数</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">pages</span> <span class="hljs-operator">=</span> pageInfo.getPages();<br>    <span class="hljs-comment">// 当前页</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">pageNum</span> <span class="hljs-operator">=</span> pageInfo.getPageNum();<br>    <span class="hljs-comment">// 每页显示长度</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">pageSize</span> <span class="hljs-operator">=</span> pageInfo.getPageSize();<br>    System.out.println(<span class="hljs-string">&quot;总条数:&quot;</span>+total);<br>    System.out.println(<span class="hljs-string">&quot;总页数:&quot;</span>+pages);<br>    System.out.println(<span class="hljs-string">&quot;当前页:&quot;</span>+pageNum);<br>    System.out.println(<span class="hljs-string">&quot;每页显示长度:&quot;</span>+pageSize);<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="分页查询可能出现的问题"><a href="#分页查询可能出现的问题" class="headerlink" title="分页查询可能出现的问题"></a>分页查询可能出现的问题</h2><blockquote>
<p>在一对多的多表查询中，pagehelper可能会出现数据显示不全的问题，这种情况使用分布查询即可解决<br>MyBatis缓存</p>
</blockquote>
<hr>
<h3 id="一级缓存"><a href="#一级缓存" class="headerlink" title="一级缓存"></a>一级缓存</h3><blockquote>
<p>一级缓存是默认开启的<br>几种不会使用一级缓存的情况</p>
</blockquote>
<ol>
<li>调用相同方法但是传入的参数不同</li>
<li>调用相同方法参数也相同，但是使用的是另外一个SqISession</li>
<li>如果查询完后，对同一个表进行了增，删改的操作，都会清空这sqlSession上的缓存</li>
<li>如果手动调用SqlSession的clearCache方法清除缓存了，后面也使用不了缓存</li>
</ol>
<h3 id="二级缓存"><a href="#二级缓存" class="headerlink" title="二级缓存"></a>二级缓存</h3><h2 id="注意-只有close或者commit后的数据才会进入二级缓存。-开启二级缓存1-全局开启-在mybatis配置文件中配置-2-局部开启-在mapper-xml里配置cache标签-需要注意的问题"><a href="#注意-只有close或者commit后的数据才会进入二级缓存。-开启二级缓存1-全局开启-在mybatis配置文件中配置-2-局部开启-在mapper-xml里配置cache标签-需要注意的问题" class="headerlink" title="注意:只有close或者commit后的数据才会进入二级缓存。#### 开启二级缓存1.  全局开启    &gt; 在mybatis配置文件中配置    2.  局部开启    &gt; 在mapper.xml里配置cache标签    需要注意的问题"></a>注意:只有close或者commit后的数据才会进入二级缓存。<br>#### 开启二级缓存<br>1.  全局开启<br><br>    &gt; 在mybatis配置文件中配置<br><br>    <figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cacheEnabled&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br></code></pre></td></tr></table></figure><br><br><br><br>2.  局部开启<br><br>    &gt; 在mapper.xml里配置cache标签<br><br>    <figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.example.mapper.PeopleMapper&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">cache</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><br><br><br>需要注意的问题</h2><ol>
<li><p>一般不用二级缓存，一级缓存是session级，而二级缓存是mapper级，即便是一个新的sqlSession，也可以获取到之前缓存里的数据，可能导致数据更改后未更新的情况</p>
</li>
<li><p>mapper里的注释不要写在sql里</p>
<p><img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202402152334703.png" alt="image-20230319162702656" data-caption="image-20230319162702656" loading="lazy"></p>
</li>
</ol>

    
  </article>

  
      

  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/MyBatis/" rel="tag">MyBatis</a>
    
</div>
  
  

  
      <div class="nexmoe-post-footer">
          <script src="https://giscus.app/client.js"
    data-repo="nexmoe/nexmoe.com"
    data-repo-id="R_kgDOJI1XUA"
    data-category="General"
    data-category-id="DIC_kwDOJI1XUM4CU1nn"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
</script>

      </div>
  
</div>
</div>
        <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MyBatis"><span class="toc-number">1.</span> <span class="toc-text">MyBatis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%92%8C-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.1.</span> <span class="toc-text">public class ApplicationTest {    private SqlSession session;    @Before    public void init() throws IOException {        String resource &#x3D; &quot;mybatis-config.xml&quot;;        InputStream inputStream &#x3D; Resources.getResourceAsStream(resource);        SqlSessionFactory sqlSessionFactory &#x3D; new SqlSessionFactoryBuilder().build(inputStream);        session&#x3D;sqlSessionFactory.openSession();    }    @After    public void destory(){        &#x2F;&#x2F; 提交事务，并释放资源        session.commit();        session.close();    }}#{}和${}的区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E6%9E%9C%E4%BD%BF%E7%94%A8-%EF%BC%8C%E4%BB%96%E6%98%AF%E9%A2%84%E7%BC%96%E8%AF%91%E7%9A%84sq%E5%8F%AF%E4%BB%A5%E9%98%B2%E6%AD%A2SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%E5%A6%82%E6%9E%9C%E4%BD%BF%E7%94%A8-%EF%BC%8C%E4%BB%96%E6%98%AF%E7%9B%B4%E6%8E%A5%E6%8A%8A%E5%8F%82%E6%95%B0%E5%80%BC%E6%8B%BF%E6%9D%A5%E8%BF%9B%E8%A1%8C%E6%8B%BC%E6%8E%A5%EF%BC%8C%E8%BF%99%E6%A0%B7%E4%BC%9A%E6%9C%89SQL%E6%B3%A8%E5%85%A5%E7%9A%84%E5%8D%B1%E9%99%A9SQL%E7%89%87%E6%AE%B5%E6%8A%BD%E5%8F%96"><span class="toc-number">1.2.</span> <span class="toc-text">如果使用#{}，他是预编译的sq可以防止SQL注入攻击如果使用${}，他是直接把参数值拿来进行拼接，这样会有SQL注入的危险SQL片段抽取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapper-xml-%E6%A0%87%E7%AD%BE"><span class="toc-number">1.3.</span> <span class="toc-text">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-&#x2F;&#x2F;mybatis.org&#x2F;&#x2F;DTD Mapper 3.0&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;mybatis.org&#x2F;dtd&#x2F;mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace&#x3D;&quot;com.example.mapper.PeopleMapper&quot;&gt;    &lt;resultMap id&#x3D;&quot;BaseResultMap&quot; type&#x3D;&quot;com.example.domain.People&quot;&gt;        &lt;id column&#x3D;&quot;ID&quot; jdbcType&#x3D;&quot;VARCHAR&quot; property&#x3D;&quot;id&quot;&#x2F;&gt;        &lt;result column&#x3D;&quot;NAME&quot; jdbcType&#x3D;&quot;VARCHAR&quot; property&#x3D;&quot;name&quot;&#x2F;&gt;        &lt;result column&#x3D;&quot;GENDER&quot; jdbcType&#x3D;&quot;DECIMAL&quot; property&#x3D;&quot;gender&quot;&#x2F;&gt;        &lt;result column&#x3D;&quot;AGE&quot; jdbcType&#x3D;&quot;DECIMAL&quot; property&#x3D;&quot;age&quot;&#x2F;&gt;    &lt;&#x2F;resultMap&gt;    &lt;sql id&#x3D;&quot;Base_Column_List&quot;&gt;        ID        , NAME, GENDER, AGE    &lt;&#x2F;sql&gt;    &lt;!-- 查询全部用户 --&gt;    &lt;select id&#x3D;&quot;selectPeople&quot; resultType&#x3D;&quot;com.example.domain.People&quot;&gt;        select        &lt;include refid&#x3D;&quot;Base_Column_List&quot;&#x2F;&gt;        from tb_people    &lt;&#x2F;select&gt;&lt;&#x2F;mapper&gt;mapper.xml 标签</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E5%AF%B9%E4%B8%80"><span class="toc-number">1.3.1.</span> <span class="toc-text">一对一</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E4%B8%80%E5%AF%B9%E5%A4%9A%E7%9A%84%E5%85%B3%E7%B3%BB%EF%BC%8C%E4%BD%86%E6%98%AF%E5%B0%B1%E4%BB%A5%E5%BC%A0%E4%B8%89%E4%BD%9C%E4%B8%BA%E6%BC%94%E7%A4%BA%EF%BC%8C%E5%BC%A0%E4%B8%89%E7%9A%84%E5%85%B3%E7%B3%BB%E6%98%AF%E4%B8%80%E5%AF%B9%E4%B8%80%E7%9A%84-%E9%A6%96%E5%85%88%E9%9C%80%E8%A6%81%E6%98%8E%E7%A1%AE%E9%80%9A%E8%BF%87%E4%BB%80%E4%B9%88%E6%9D%A5%E6%9F%A5%E4%BB%80%E4%B9%88%EF%BC%9F-%E6%88%91%E4%BB%AC%E7%8E%B0%E5%9C%A8%E9%9C%80%E8%A6%81%E9%80%9A%E8%BF%87%E4%BD%BF%E7%94%A8%E8%80%85%E6%9D%A5%E6%9F%A5%E8%AF%A2%E4%BB%96%E7%9A%84%E6%89%8B%E6%9C%BA%EF%BC%8C%E6%89%80%E4%BB%A5%E9%9C%80%E8%A6%81%E5%9C%A8%E4%BD%BF%E7%94%A8%E8%80%85%E7%9A%84%E5%B1%9E%E6%80%A7%E9%87%8C%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%89%8B%E6%9C%BA-%E5%88%AB%E5%BF%98%E4%BA%86%E7%94%9F%E6%88%90%E5%AF%B9%E5%BA%94%E5%B1%9E%E6%80%A7%E7%9A%84get%E3%80%81set%E7%AD%89%E6%96%B9%E6%B3%95%E5%93%A6-%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2-%E5%85%88%E6%B5%8B%E8%AF%95%E4%B8%80%E4%B8%8Bsql%E6%98%AF%E5%90%A6%E6%AD%A3%E7%A1%AE%E5%86%99%E6%B3%951%E5%86%99%E6%B3%952-%E4%BB%A5%E4%B8%8A%E4%B8%A4%E7%A7%8D%E5%86%99%E6%B3%95%E9%83%BD%E8%83%BD%E6%9F%A5%E8%AF%A2%E5%88%B0%E7%BB%93%E6%9E%9C-%E4%B8%80%E5%AF%B9%E5%A4%9A-%E6%8E%A5%E4%B8%8B%E6%9D%A5%E6%B5%8B%E8%AF%95%E4%B8%80%E5%AF%B9%E5%A4%9A%EF%BC%8C%E5%B0%86Phone-phone-%E6%94%B9%E6%88%90List-phones-%E5%88%86%E6%AD%A5%E6%9F%A5%E8%AF%A2-%E5%88%86%E5%B8%83%E6%9F%A5%E8%AF%A2%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%AE%8C%E6%88%90%E4%BB%A5%E4%B8%8A%E6%93%8D%E4%BD%9C-%E6%88%91%E4%BB%AC%E5%88%86%E4%B8%BA%E4%B8%A4%E4%B8%AAselect%E6%93%8D%E4%BD%9C-1-%E6%9F%A5%E6%89%BE%E5%88%B0%E5%AF%B9%E5%BA%94%E7%9A%84%E6%89%8B%E6%9C%BAid-%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%83%A8-2-%E6%A0%B9%E6%8D%AE%E6%89%8B%E6%9C%BAid%E6%9F%A5%E6%89%BE%E5%88%B0%E5%AF%B9%E5%BA%94%E7%9A%84%E6%89%8B%E6%9C%BA-%E5%9C%A8%E6%96%B9%E6%B3%95%E4%B8%8A%E5%8F%B3%E9%94%AE%EF%BC%8C%E9%80%89%E6%8B%A9copy-reference%E5%B0%86id%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0%E4%BC%A0%E7%BB%99findRoleByUserId%E6%96%B9%E6%B3%95-%E6%9F%A5%E7%9C%8B%E6%89%93%E5%8D%B0%E7%9A%84%E6%97%A5%E5%BF%97-%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%89%A7%E8%A1%8C%E4%BA%86%E4%B8%A4%E4%B8%AAsql%E5%88%86%E5%B8%83%E6%9F%A5%E8%AF%A2%E9%87%8C%E7%9A%84%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD"><span class="toc-number">1.4.</span> <span class="toc-text">&gt; 可以看到这是一个一对多的关系，但是就以张三作为演示，张三的关系是一对一的&gt;&gt; 首先需要明确通过什么来查什么？&gt;&gt; 我们现在需要通过使用者来查询他的手机，所以需要在使用者的属性里新建一个手机&gt;&gt; 别忘了生成对应属性的get、set等方法哦#### 关联查询&gt; 先测试一下sql是否正确select tb_people.id &quot;id&quot;,       tb_people.name &quot;name&quot;,       tb_people.gender &quot;gender&quot;,       tb_people.age &quot;age&quot;,       tb_phone.id    &quot;phone_id&quot;,       tb_phone.name  &quot;phone_name&quot;,       tb_phone.brand &quot;phone_brand&quot;,       tb_phone.price &quot;phone_price&quot;from tb_people,     tb_people_phone_detail,     tb_phonewhere tb_people.id &#x3D; tb_people_phone_detail.people_id(+)  and tb_people_phone_detail.phone_id &#x3D; tb_phone.id(+)  and tb_people.id &#x3D; &#39;6f226961637346ec82499567122e00ea&#39;写法1写法2&gt; 以上两种写法都能查询到结果### 一对多&gt; 接下来测试一对多，将Phone phone 改成List&lt;Phone&gt; phones&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-&#x2F;&#x2F;mybatis.org&#x2F;&#x2F;DTD Mapper 3.0&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;mybatis.org&#x2F;dtd&#x2F;mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace&#x3D;&quot;com.example.mapper.PeopleMapper&quot;&gt;    &lt;resultMap id&#x3D;&quot;BaseResultMap&quot; type&#x3D;&quot;com.example.domain.People&quot;&gt;        &lt;id column&#x3D;&quot;ID&quot; jdbcType&#x3D;&quot;VARCHAR&quot; property&#x3D;&quot;id&quot;&#x2F;&gt;        &lt;result column&#x3D;&quot;NAME&quot; jdbcType&#x3D;&quot;VARCHAR&quot; property&#x3D;&quot;name&quot;&#x2F;&gt;        &lt;result column&#x3D;&quot;GENDER&quot; jdbcType&#x3D;&quot;DECIMAL&quot; property&#x3D;&quot;gender&quot;&#x2F;&gt;        &lt;result column&#x3D;&quot;AGE&quot; jdbcType&#x3D;&quot;DECIMAL&quot; property&#x3D;&quot;age&quot;&#x2F;&gt;    &lt;&#x2F;resultMap&gt;    &lt;sql id&#x3D;&quot;Base_Column_List&quot;&gt;        ID        , NAME, GENDER, AGE    &lt;&#x2F;sql&gt;    &lt;resultMap id&#x3D;&quot;PeoplePhonesResultMap&quot; type&#x3D;&quot;com.example.domain.People&quot; extends&#x3D;&quot;BaseResultMap&quot;&gt;        &lt;collection property&#x3D;&quot;phones&quot; ofType&#x3D;&quot;com.example.domain.Phone&quot;&gt;            &lt;id column&#x3D;&quot;phone_id&quot; property&#x3D;&quot;id&quot;&#x2F;&gt;            &lt;result column&#x3D;&quot;phone_name&quot; property&#x3D;&quot;name&quot;&#x2F;&gt;            &lt;result column&#x3D;&quot;phone_brand&quot; property&#x3D;&quot;brand&quot;&#x2F;&gt;            &lt;result column&#x3D;&quot;phone_price&quot; property&#x3D;&quot;price&quot;&#x2F;&gt;        &lt;&#x2F;collection&gt;    &lt;&#x2F;resultMap&gt;    &lt;!-- 根据用户id查询 --&gt;    &lt;select id&#x3D;&quot;selectPeopleWithPhones&quot; resultType&#x3D;&quot;com.example.domain.People&quot;&gt;        select tb_people.id &quot;id&quot;,               tb_people.name &quot;name&quot;,               tb_people.gender &quot;gender&quot;,               tb_people.age &quot;age&quot;,               tb_phone.id    &quot;phone_id&quot;,               tb_phone.name  &quot;phone_name&quot;,               tb_phone.brand &quot;phone_brand&quot;,               tb_phone.price &quot;phone_price&quot;        from tb_people,             tb_people_phone_detail,             tb_phone        where tb_people.id &#x3D; tb_people_phone_detail.people_id(+)          and tb_people_phone_detail.phone_id &#x3D; tb_phone.id(+)          and tb_people.id &#x3D; #{id}    &lt;&#x2F;select&gt;    &lt;!-- 查询全部用户 --&gt;    &lt;select id&#x3D;&quot;selectPeople&quot; resultType&#x3D;&quot;com.example.domain.People&quot;&gt;        select        &lt;include refid&#x3D;&quot;Base_Column_List&quot;&#x2F;&gt;        from tb_people    &lt;&#x2F;select&gt;&lt;&#x2F;mapper&gt;### 分步查询&gt; 分布查询也可以完成以上操作&gt;&gt; 我们分为两个select操作&gt;&gt; 1.  查找到对应的手机id(可能是多部)&gt; 2.  根据手机id查找到对应的手机&gt; 在方法上右键，选择copy reference将id作为参数传给findRoleByUserId方法&gt; 查看打印的日志&gt;&gt; 可以看到执行了两个sql分布查询里的按需加载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%99%E9%87%8C%E6%88%91%E4%BB%AC%E5%8F%AA%E6%89%93%E5%8D%B0%E8%BE%93%E5%87%BA%E4%BA%86%E4%BA%BA%E7%9A%84id%EF%BC%8C%E5%B9%B6%E6%B2%A1%E6%9C%89%E6%B6%89%E5%8F%8A%E5%88%B0%E6%89%8B%E6%9C%BA%E7%9A%84%E4%BF%A1%E6%81%AF%EF%BC%8C%E6%89%80%E4%BB%A5%E5%8F%AA%E6%89%A7%E8%A1%8C%E4%BA%86%E4%B8%80%E4%B8%AAsql%E8%AF%AD%E5%8F%A5%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.</span> <span class="toc-text">&gt; 这里我们只打印输出了人的id，并没有涉及到手机的信息，所以只执行了一个sql语句分页查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.</span> <span class="toc-text">分页查询可能出现的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-number">1.6.1.</span> <span class="toc-text">一级缓存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-number">1.6.2.</span> <span class="toc-text">二级缓存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F-%E5%8F%AA%E6%9C%89close%E6%88%96%E8%80%85commit%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%E6%89%8D%E4%BC%9A%E8%BF%9B%E5%85%A5%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E3%80%82-%E5%BC%80%E5%90%AF%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%981-%E5%85%A8%E5%B1%80%E5%BC%80%E5%90%AF-%E5%9C%A8mybatis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E9%85%8D%E7%BD%AE-2-%E5%B1%80%E9%83%A8%E5%BC%80%E5%90%AF-%E5%9C%A8mapper-xml%E9%87%8C%E9%85%8D%E7%BD%AEcache%E6%A0%87%E7%AD%BE-%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.7.</span> <span class="toc-text">注意:只有close或者commit后的数据才会进入二级缓存。#### 开启二级缓存1.  全局开启    &gt; 在mybatis配置文件中配置    &lt;settings&gt;    &lt;setting name&#x3D;&quot;cacheEnabled&quot; value&#x3D;&quot;true&quot;&#x2F;&gt;&lt;&#x2F;settings&gt;2.  局部开启    &gt; 在mapper.xml里配置cache标签    &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-&#x2F;&#x2F;mybatis.org&#x2F;&#x2F;DTD Mapper 3.0&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;mybatis.org&#x2F;dtd&#x2F;mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace&#x3D;&quot;com.example.mapper.PeopleMapper&quot;&gt;    &lt;cache&#x2F;&gt;&lt;&#x2F;mapper&gt;需要注意的问题</span></a></li></ol></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
    </div>
    <div id="nexmoe-search-space">
	<div class="search-container">
		<div class="search-header">
			<div class="search-input-container">
				<input
					class="search-input"
					type="text"
					placeholder="搜索"
					oninput="sinput();"
				/>
			</div>
			<a class="search-close" onclick="sclose();">×</a>
		</div>
		<div class="search-body"></div>
	</div>
</div>

    
    
</body>

</html>
