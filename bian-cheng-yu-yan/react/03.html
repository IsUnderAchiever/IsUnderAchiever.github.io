<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>03.Mobx - 折影轻梦</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="折影轻梦,Mixcm,轻惋,觅漫者,小舒同学,Xiaoshu,Nexmoe,产品,Meteor,探索者小舒,伴学OS1,Theme,Design,Product">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
    <meta name="description" content="1. Mobx介绍  一个可以和React良好配合的集中状态管理工具，和Redux解决的问题相似，都可以独立组件进行集中状态管理 优势 简单  编写无模板的极简代码精准描述你的意图  轻松实现最优渲染  依赖自动追踪，实现最小渲染优化 架构自由  可移植, 可测试 无特殊心智负担  社区评价      2. 配置开发环境  Mobx是一个独立的响应式的库，可以独立于任何UI框架存在，但是通常大家习">
<meta property="og:type" content="article">
<meta property="og:title" content="03.Mobx">
<meta property="og:url" content="https://isunderachiever.github.io/bian-cheng-yu-yan/react/03.html">
<meta property="og:site_name" content="折影轻梦">
<meta property="og:description" content="1. Mobx介绍  一个可以和React良好配合的集中状态管理工具，和Redux解决的问题相似，都可以独立组件进行集中状态管理 优势 简单  编写无模板的极简代码精准描述你的意图  轻松实现最优渲染  依赖自动追踪，实现最小渲染优化 架构自由  可移植, 可测试 无特殊心智负担  社区评价      2. 配置开发环境  Mobx是一个独立的响应式的库，可以独立于任何UI框架存在，但是通常大家习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139607.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139213.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139018.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139533.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139203.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139117.png">
<meta property="og:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139716.png">
<meta property="article:published_time" content="2023-06-02T16:00:00.000Z">
<meta property="article:modified_time" content="2024-06-01T14:32:53.518Z">
<meta property="article:author" content="折影轻梦">
<meta property="article:tag" content="React">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139607.png">
    
<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1717340472289">
    
    <link rel="stylesheet" href="/css/style.css?v=1717340472289">

    
        
            <link rel="stylesheet" href="/custom.css?v=1717340472289">
        
    

    
<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>


    <script async src="/js/app.js?v=1717340472289"></script>
    
     

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>

<meta name="generator" content="Hexo 6.3.0"></head>

<body class="mdui-drawer-body-left">
    <div id="nexmoe-background">
        <div class="nexmoe-bg" 
            style="background-image: url(https://raw.githubusercontent.com/IsUnderAchiever/blog-img/master/about/202309161102206.jpg)"
        ></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="折影轻梦" class="mdui-btn mdui-btn-icon"><img src="https://raw.githubusercontent.com/IsUnderAchiever/blog-img/master/about/202309161102017.jpg" alt="折影轻梦"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="折影轻梦">
            <img src="https://raw.githubusercontent.com/IsUnderAchiever/blog-img/master/about/202309161102017.jpg" alt="折影轻梦" alt="折影轻梦">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>169</div>
        <div><span>标签</span>62</div>
        <div><span>分类</span>63</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/life.html" title="我的生活">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的生活
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about.html" title="关于博主">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博主
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
        
            
            <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
        
            <form id="search_form">
                <label><input class="st-default-search-input" id="search_value" name="q" type="search" placeholder="搜索" style="
                    font-size: 15px !important;
                    height: 56px !important;
                    background-image: none;
                "></label>
            </form>
         
    </div>
</div>


	<script async src="/js/search.js?v=1717340472289"></script>



        
            
            <div class="nexmoe-widget-wrap">
	<div class="nexmoe-widget nexmoe-social">
		<a
			class="mdui-ripple"
			href="https://github.com/IsUnderAchiever/"
			target="_blank"
			mdui-tooltip="{content: 'QQ群'}"
			style="
				color: rgb(249, 174, 8);
				background-color: rgba(249, 174, 8, .1);
			"
		>
			<i
				class="nexmoefont icon-QQ"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://space.bilibili.com/477448861/"
			target="_blank"
			mdui-tooltip="{content: '哔哩哔哩'}"
			style="
				color: rgb(231, 106, 141);
				background-color: rgba(231, 106, 141, .1);
			"
		>
			<i
				class="nexmoefont icon-bilibili"
			></i> </a
		>
	</div>
</div>

        
            
            
            
            
            
            
    </aside>
    <div class="nexmoe-copyright">
        &copy; 2024 折影轻梦
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
    <div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover"> 
            <img src="https://raw.githubusercontent.com/IsUnderAchiever/blog-img/master/about/202309161102206.jpg" alt="03.Mobx" loading="lazy">
            <h1>03.Mobx</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2023年06月03日</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/React/">React</a>
        
        
    </div>
    
    
    
    
    
</div>

    <h1 id="1-Mobx介绍"><a href="#1-Mobx介绍" class="headerlink" title="1. Mobx介绍"></a>1. Mobx介绍</h1><p>  一个可以和React良好配合的集中状态管理工具，和Redux解决的问题相似，都可以独立组件进行集中状态管理</p>
<h2 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h2><ol>
<li>简单<br>  编写无模板的极简代码精准描述你的意图 </li>
<li>轻松实现最优渲染<br>  依赖自动追踪，实现最小渲染优化</li>
<li>架构自由<br>  可移植, 可测试 无特殊心智负担</li>
</ol>
<h2 id="社区评价"><a href="#社区评价" class="headerlink" title="社区评价"></a>社区评价</h2>  <img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139607.png" alt="img" data-caption="img" loading="lazy">
  
<h1 id="2-配置开发环境"><a href="#2-配置开发环境" class="headerlink" title="2. 配置开发环境"></a>2. 配置开发环境</h1><p>  Mobx是一个独立的响应式的库，可以独立于任何UI框架存在，但是通常大家习惯把它和React进行绑定使用，用Mobx来做响应式数据建模，React作为UI视图框架渲染内容，我们环境的配置需要三个部分</p>
<ol>
<li>一个create-react-app创建好的React项目环境</li>
<li>mobx框架本身</li>
<li>一个用来链接mobx和React的中间件  <figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 创建项目</span><br>$ yarn create vite react-mobx --template react<br><br><span class="hljs-comment"># 安装mobx和中间件工具 mobx-react-lite  只能函数组件中使用</span><br>$ yarn add  mobx  mobx-react-lite<br></code></pre></td></tr></table></figure></li>
</ol>
<h1 id="3-基础使用"><a href="#3-基础使用" class="headerlink" title="3. 基础使用"></a>3. 基础使用</h1><p>  需求: 使用mobx实现一个计数器的案例</p>
<p>  <img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139213.png" alt="img" data-caption="img" loading="lazy"></p>
<h2 id="1-初始化mobx"><a href="#1-初始化mobx" class="headerlink" title="1. 初始化mobx"></a>1. 初始化mobx</h2><p>  初始化步骤</p>
<ol>
<li>定义数据状态<strong>state</strong></li>
<li>在构造器中实现数据响应式处理 <strong>makeAutoObservble</strong></li>
<li>定义修改数据的函数<strong>action</strong></li>
<li>实例化store并导出  <figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterStore</span> &#123;<br>  count = <span class="hljs-number">0</span> <span class="hljs-comment">// 定义数据</span><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)  <span class="hljs-comment">// 响应式处理</span><br>  &#125;<br>  <span class="hljs-comment">// 定义修改数据的方法</span><br>  addCount = <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> counter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CounterStore</span>()<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> counter<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="2-React使用store"><a href="#2-React使用store" class="headerlink" title="2. React使用store"></a>2. React使用store</h2><p>  实现步骤</p>
<ol>
<li>在组件中导入counterStore实例对象</li>
<li>在组件中使用storeStore实例对象中的数据</li>
<li>通过事件调用修改数据的方法修改store中的数据</li>
<li>让组件响应数据变化</li>
</ol>
  <figure class="highlight jsx"><table><tr><td class="code"><pre><code class="hljs jsx"><span class="hljs-comment">// 导入counterStore</span><br><span class="hljs-keyword">import</span> counterStore <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><br><span class="hljs-comment">// 导入observer方法</span><br><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx-react-lite&#x27;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;App&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> counterStore.addCount()&#125;&gt;</span><br><span class="language-xml">        &#123;counterStore.count&#125;</span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br><span class="hljs-comment">// 包裹组件让视图响应数据变化</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">observer</span>(<span class="hljs-title class_">App</span>)<br></code></pre></td></tr></table></figure>
<h1 id="4-计算属性（衍生状态）"><a href="#4-计算属性（衍生状态）" class="headerlink" title="4. 计算属性（衍生状态）"></a>4. 计算属性（衍生状态）</h1><p>  概念: 有一些状态根据现有的状态计算（衍生）得到，我们把这种状态叫做计算属性, 看下面的例子<br>  <img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139018.png" alt="img" data-caption="img" loading="lazy"></p>
<p>  实现步骤</p>
<ol>
<li>生命一个存在的数据</li>
<li>通过get关键词 定义计算属性</li>
<li>在 makeAutoObservable 方法中标记计算属性</li>
</ol>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; computed, makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterStore</span> &#123;<br>  list = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>, &#123;<br>      <span class="hljs-attr">filterList</span>: computed<br>    &#125;)<br>  &#125;<br>  <span class="hljs-comment">// 修改原数组</span><br>  changeList = <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">push</span>(<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>)<br>  &#125;<br>  <span class="hljs-comment">// 定义计算属性</span><br>  get filterList () &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item &gt; <span class="hljs-number">4</span>)<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> counter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CounterStore</span>()<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> counter<br><span class="hljs-comment">// 导入counterStore</span><br><span class="hljs-keyword">import</span> counterStore <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><br><span class="hljs-comment">// 导入observer方法</span><br><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx-react-lite&#x27;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;App&quot;</span>&gt;</span></span><br><span class="language-xml">      &#123;/* 原数组 */&#125;</span><br><span class="language-xml">      &#123;JSON.stringify(counterStore.list)&#125;</span><br><span class="language-xml">      &#123;/* 计算属性 */&#125;</span><br><span class="language-xml">      &#123;JSON.stringify(counterStore.filterList)&#125;</span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> counterStore.changeList()&#125;&gt;change list<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br><span class="hljs-comment">// 包裹组件让视图响应数据变化</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">observer</span>(<span class="hljs-title class_">App</span>)<br></code></pre></td></tr></table></figure>
<h1 id="5-异步数据处理"><a href="#5-异步数据处理" class="headerlink" title="5. 异步数据处理"></a>5. 异步数据处理</h1><p>  测试接口: <a target="_blank" rel="noopener" href="http://geek.itheima.net/v1_0/channels'">http://geek.itheima.net/v1_0&#x2F;channels</a><br>  实现步骤:</p>
<ol>
<li>在mobx中编写异步请求方法 获取数据 存入state中</li>
<li>组件中通过 useEffect + 空依赖  触发action函数的执行   <figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 异步的获取</span><br><br><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx&#x27;</span><br><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ChannelStore</span> &#123;<br>  channelList = []<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)<br>  &#125;<br>  <span class="hljs-comment">// 只要调用这个方法 就可以从后端拿到数据并且存入channelList</span><br>  setChannelList = <span class="hljs-keyword">async</span> () =&gt; &#123;<br>    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;http://geek.itheima.net/v1_0/channels&#x27;</span>)<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">channelList</span> = res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>.<span class="hljs-property">channels</span><br>  &#125;<br>&#125;<br><span class="hljs-keyword">const</span> channlStore = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelStore</span>()<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> channlStore<br><span class="hljs-keyword">import</span> &#123; useEffect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><br><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx-react-lite&#x27;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> &#123; channlStore &#125; = <span class="hljs-title function_">useStore</span>()<br>  <span class="hljs-comment">// 1. 使用数据渲染组件</span><br>  <span class="hljs-comment">// 2. 触发action函数发送异步请求</span><br>  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    channlStore.<span class="hljs-title function_">setChannelList</span>()<br>  &#125;, [])<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">      &#123;channlStore.channelList.map((item) =&gt; (</span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">      ))&#125;</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br>  )<br>&#125;<br><span class="hljs-comment">// 让组件可以响应数据的变化[也就是数据一变组件重新渲染]</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">observer</span>(<span class="hljs-title class_">App</span>)<br></code></pre></td></tr></table></figure></li>
</ol>
<h1 id="6-模块化"><a href="#6-模块化" class="headerlink" title="6. 模块化"></a>6. 模块化</h1><p>  场景: 一个项目有很多的业务模块，我们不能把所有的代码都写到一起，这样不好维护，提了提供可维护性，需要引入模块化机制<br>  <img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139533.png" alt="img" data-caption="img" loading="lazy"></p>
<p>  <strong>实现步骤</strong></p>
<ol>
<li>拆分模块js文件，每个模块中定义自己独立的state&#x2F;action</li>
<li>在store&#x2F;index.js中导入拆分之后的模块，进行模块组合</li>
<li>利用React的context的机制导出统一的useStore方法，给业务组件使用</li>
</ol>
<p>  1- 定义task模块<br>  <figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskStore</span> &#123;<br>  taskList = []<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)<br>  &#125;<br>  addTask () &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskList</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;vue&#x27;</span>, <span class="hljs-string">&#x27;react&#x27;</span>)<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> task = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TaskStore</span>()<br><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> task<br></code></pre></td></tr></table></figure></p>
<p>  2- 定义counterStore<br>  <figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterStore</span> &#123;<br>  count = <span class="hljs-number">0</span><br>  list = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)<br>  &#125;<br>  addCount = <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++<br>  &#125;<br>  changeList = <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">push</span>(<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>)<br>  &#125;<br>  get filterList () &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item &gt; <span class="hljs-number">4</span>)<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> counter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CounterStore</span>()<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> counter<br></code></pre></td></tr></table></figure><br>  3- 组合模块导出统一方法<br>  <figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-keyword">import</span> counter <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./counterStore&#x27;</span><br><span class="hljs-keyword">import</span> task <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./taskStore&#x27;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RootStore</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">counterStore</span> = counter<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskStore</span> = task<br>  &#125;<br>&#125;<br><br><br><span class="hljs-keyword">const</span> rootStore = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RootStore</span>()<br><br><span class="hljs-comment">// context机制的数据查找链  Provider如果找不到 就找createContext方法执行时传入的参数</span><br><span class="hljs-keyword">const</span> context = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createContext</span>(rootStore)<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">useStore</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useContext</span>(context)<br><span class="hljs-comment">// useStore() =&gt;  rootStore  &#123; counterStore, taskStore &#125;</span><br><br><span class="hljs-keyword">export</span> &#123; useStore &#125;<br></code></pre></td></tr></table></figure><br>  4- 组件使用模块中的数据<br>  <figure class="highlight jsx"><table><tr><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx-react-lite&#x27;</span><br><span class="hljs-comment">// 导入方法</span><br><span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// 得到store</span><br>  <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useStore</span>()<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;App&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> store.counterStore.addCount()&#125;&gt;</span><br><span class="language-xml">        &#123;store.counterStore.count&#125;</span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br><span class="hljs-comment">// 包裹组件让视图响应数据变化</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">observer</span>(<span class="hljs-title class_">App</span>)<br></code></pre></td></tr></table></figure></p>
<h1 id="7-多组件共享数据"><a href="#7-多组件共享数据" class="headerlink" title="7. 多组件共享数据"></a>7. 多组件共享数据</h1><p>  目标：当数据发生变化 所有用到数据的组件都会得到同步的组件的更新<br>  实现步骤：在Foo组件和Bar组件中分别使用store中的数据，然后在app组件中进行数据修改，查看Foo组件和Bar组件是否得到更新<br>  <img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139203.png" alt="img" data-caption="img" loading="lazy"><br>  <figure class="highlight jsx"><table><tr><td class="code"><pre><code class="hljs jsx"><span class="hljs-comment">// 用taskStore中的taskList数据</span><br><span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><br><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx-react-lite&#x27;</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">Bar</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> &#123; taskStore &#125; = <span class="hljs-title function_">useStore</span>()<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">      &#123;taskStore.taskList.map((item) =&gt; (</span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;item&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">      ))&#125;</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br>  )<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">observer</span>(<span class="hljs-title class_">Son</span>)<br><span class="hljs-comment">// 用taskStore中的taskList数据</span><br><span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><br><span class="hljs-keyword">import</span> &#123; observer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx-react-lite&#x27;</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">Bar</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> &#123; taskStore &#125; = <span class="hljs-title function_">useStore</span>()<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">      &#123;taskStore.taskList.map((item) =&gt; (</span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;item&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">      ))&#125;</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br>  )<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">observer</span>(<span class="hljs-title class_">Son</span>)<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Bar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Bar&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Foo</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Foo&#x27;</span><br><span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> &#123; taskStore &#125; = <span class="hljs-title function_">useStore</span>()<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;App&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">Bar</span> /&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> taskStore.setTaskList(&#x27;angular&#x27;)&#125;&gt;</span><br><span class="language-xml">        修改taskStore</span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span><br></code></pre></td></tr></table></figure></p>
<h1 id="8-Todos综合案例"><a href="#8-Todos综合案例" class="headerlink" title="8. Todos综合案例"></a>8. Todos综合案例</h1><p>  <img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139117.png" alt="img" data-caption="img" loading="lazy"></p>
<h2 id="1-开发环境搭建"><a href="#1-开发环境搭建" class="headerlink" title="1. 开发环境搭建"></a>1. 开发环境搭建</h2>  <figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 克隆模块到本地</span><br>$ git <span class="hljs-built_in">clone</span> https://gitee.com/react-course-series/mobx_react.git<br><br><span class="hljs-comment"># 安装所有依赖</span><br>$ yarn <br><br><span class="hljs-comment"># master分支是一个静态的模板  在这个里面进行开发</span><br><span class="hljs-comment"># finished-mvc分支是一个写完的版本  供参考</span><br></code></pre></td></tr></table></figure>
<h2 id="2-Mobx和React的职责划分"><a href="#2-Mobx和React的职责划分" class="headerlink" title="2. Mobx和React的职责划分"></a>2. Mobx和React的职责划分</h2><p>  <img onerror="imgOnError(this);" data-fancybox="gallery" src="https://raw.githubusercontent.com/IsUnderAchiever/markdown-img/master/PicGo01/202307132139716.png" alt="img" data-caption="img" loading="lazy"></p>
<h2 id="3-列表渲染"><a href="#3-列表渲染" class="headerlink" title="3. 列表渲染"></a>3. 列表渲染</h2>  <figure class="highlight jsx"><table><tr><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./index.css&#x27;</span><br><span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../store&#x27;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Task</span> () &#123;<br>  <span class="hljs-keyword">const</span> &#123; taskStore &#125; = <span class="hljs-title function_">useStore</span>()<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;todoapp&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;main&quot;</span>&gt;</span></span><br><span class="language-xml">        &#123;/* 省略 */&#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;todo-list&quot;</span>&gt;</span></span><br><span class="language-xml">          &#123;/* 列表区域 */&#125;</span><br><span class="language-xml">          &#123;taskStore.list.map(item =&gt; (</span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;todo&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;item.id&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            &gt;</span></span><br><span class="language-xml">              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;view&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><br><span class="hljs-tag"><span class="language-xml">                  <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;toggle&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                 /&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> &gt;</span>&#123;item.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;destroy&quot;</span>&#125;&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">          ))&#125;</span><br><span class="language-xml"></span><br><span class="language-xml">          &#123;/* <span class="hljs-tag">&lt;<span class="hljs-name">li</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;todo completed&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">          &gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;view&quot;</span>&gt;</span></span><br><span class="language-xml">              <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;toggle&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">defaultChecked</span>=<span class="hljs-string">&#123;true&#125;</span> /&gt;</span></span><br><span class="language-xml">              <span class="hljs-tag">&lt;<span class="hljs-name">label</span> &gt;</span>learn react<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span><br><span class="language-xml">              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;destroy&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span> */&#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">footer</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;footer&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;todo-count&quot;</span>&gt;</span></span><br><span class="language-xml">          任务总数: &#123;10&#125; 已完成: &#123;1&#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span></span><br>  )<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">observer</span>(<span class="hljs-title class_">Task</span>)<br></code></pre></td></tr></table></figure>
<h2 id="4-单选实现"><a href="#4-单选实现" class="headerlink" title="4. 单选实现"></a>4. 单选实现</h2><p>  实现思路和步骤: 本质上是在实现双向绑定</p>
<ol>
<li>通过store中的数据状态 isDone字段 绑定到input元素的 checked属性上</li>
<li>监听事件 调用mobx的对应方法 传入id   找到要修改的项 把isDone字段取反操作  <figure class="highlight jsx"><table><tr><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> &#123; makeAutoObservable &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx&#x27;</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskStore</span> &#123;<br>  list = [<br>    &#123;<br>      <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;学习react&#x27;</span>,<br>      <span class="hljs-attr">isDone</span>: <span class="hljs-literal">true</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;搞定mobx&#x27;</span>,<br>      <span class="hljs-attr">isDone</span>: <span class="hljs-literal">false</span><br>    &#125;<br>  ]<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">makeAutoObservable</span>(<span class="hljs-variable language_">this</span>)<br>  &#125;<br>  <span class="hljs-comment">// 进行单选修改数据的方法</span><br>  checkItem = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === id)<br>    item.<span class="hljs-property">isDone</span> = !item.<span class="hljs-property">isDone</span><br>  &#125;<br>&#125;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">TaskStore</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">onChange</span> = (<span class="hljs-params">id</span>) =&gt; taskStore.<span class="hljs-title function_">checkItem</span>(id)<br><br>&lt;input<br>    className=<span class="hljs-string">&quot;toggle&quot;</span><br>    type=<span class="hljs-string">&quot;checkbox&quot;</span><br>    checked=&#123;item.<span class="hljs-property">isDone</span>&#125;<br>    onChange=&#123;<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">onChange</span>(item.<span class="hljs-property">id</span>)&#125;<br>/&gt;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="5-删除功能"><a href="#5-删除功能" class="headerlink" title="5. 删除功能"></a>5. 删除功能</h2><p>  实现思路和步骤：</p>
<ol>
<li>在mobx中定义好删除数据的方法<br>\2.  点击删除 调用mobx提供的删除方法 传出id   进行删除  <figure class="highlight json"><table><tr><td class="code"><pre><code class="hljs json"><span class="hljs-comment">// 删除的方法</span><br>delItem = (id) =&gt; <span class="hljs-punctuation">&#123;</span><br>  this.list = this.list.filter(item =&gt; item.id !== id)<br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment">// 删除操作</span><br>const onDel = (id) =&gt; taskStore.delItem(id)<br><br>&lt;button className=<span class="hljs-string">&quot;destroy&quot;</span> onClick=<span class="hljs-punctuation">&#123;</span>() =&gt; onDel(item.id)<span class="hljs-punctuation">&#125;</span>&gt;&lt;/button&gt;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="6-全选功能"><a href="#6-全选功能" class="headerlink" title="6. 全选功能"></a>6. 全选功能</h2><p>  实现思路和步骤: </p>
<ol>
<li>实现数据驱动权限UI显示   通过计算属性 + every方法</li>
<li>实现点击权限 控制所有子项   change事件拿到e.target.checked 遍历list进行isDone赋值  <figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 是否全选的计算属性</span><br>get isAll () &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">every</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">isDone</span>)<br>&#125;<br><br><span class="hljs-comment">// 遍历修改所有item</span><br>allCheckItem = <span class="hljs-function">(<span class="hljs-params">checked</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>    item.<span class="hljs-property">isDone</span> = checked<br>  &#125;)<br>&#125;<br><span class="hljs-comment">// 全选操作回调</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">allChange</span> = (<span class="hljs-params">e</span>) =&gt; &#123;<br>  <span class="hljs-comment">// 通过事件对象e拿到当前是否选中的状态 </span><br>  taskStore.<span class="hljs-title function_">allCheckItem</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">checked</span>)<br>&#125;<br><br>&#123;<span class="hljs-comment">/* 全选框 */</span>&#125;<br>&lt;input<br>  id=<span class="hljs-string">&quot;toggle-all&quot;</span><br>  className=<span class="hljs-string">&quot;toggle-all&quot;</span><br>  type=<span class="hljs-string">&quot;checkbox&quot;</span><br>  checked=&#123;taskStore.<span class="hljs-property">isAll</span>&#125;<br>  onChange=&#123;allChange&#125;<br>/&gt;<br></code></pre></td></tr></table></figure>
  \7. 新增功能<br>  实现思路和步骤:</li>
<li>在mobx中编写新增方法的逻辑</li>
<li>在组件中通过受控方式维护输入框中的数据</li>
<li>在组件中监听keyUp方法  判断当前是否点击的是回车键 如果是 调用mobx的方法进行新增  <figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">  addItem = <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">push</span>(item)<br>  &#125;<br><span class="hljs-comment">// 受控方式维护输入框数据</span><br><span class="hljs-keyword">const</span> [keyword, setKeyword] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">keywordChange</span> = (<span class="hljs-params">e</span>) =&gt; &#123;<br>  <span class="hljs-title function_">setKeyword</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>)<br>&#125;<br><br><span class="hljs-comment">// 键盘抬起事件中 判断code码进行新增</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">onKeyUp</span> = (<span class="hljs-params">e</span>) =&gt; &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e)<br>  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">keyCode</span> === <span class="hljs-number">13</span>) &#123;<br>    taskStore.<span class="hljs-title function_">addItem</span>(&#123;<br>      <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,<br>      <span class="hljs-attr">name</span>: keyword,<br>      <span class="hljs-attr">isDone</span>: <span class="hljs-literal">false</span><br>    &#125;)<br>    <span class="hljs-comment">// 新增完毕置空</span><br>    <span class="hljs-title function_">setKeyword</span>(<span class="hljs-string">&#x27;&#x27;</span>)<br>  &#125;<br>&#125;<br><br>&lt;input<br>  className=<span class="hljs-string">&quot;new-todo&quot;</span><br>  autoFocus<br>  autoComplete=<span class="hljs-string">&quot;off&quot;</span><br>  placeholder=<span class="hljs-string">&quot;What needs to be done?&quot;</span><br>  value=&#123;keyword&#125;<br>  onChange=&#123;keywordChange&#125;<br>  onKeyUp=&#123;onKeyUp&#125;<br>/&gt;<br></code></pre></td></tr></table></figure></li>
</ol>

    
  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>本文作者：</strong>折影轻梦<br>
        <strong>本文链接：</strong><a href="https://isunderachiever.github.io/bian-cheng-yu-yan/react/03.html" title="https:&#x2F;&#x2F;isunderachiever.github.io&#x2F;bian-cheng-yu-yan&#x2F;react&#x2F;03.html" target="_blank" rel="noopener">https:&#x2F;&#x2F;isunderachiever.github.io&#x2F;bian-cheng-yu-yan&#x2F;react&#x2F;03.html</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可

        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/React/" rel="tag">React</a>
    
</div>
  
  

  
      <div class="nexmoe-post-footer">
          <script src="https://giscus.app/client.js"
    data-repo="nexmoe/nexmoe.com"
    data-repo-id="R_kgDOJI1XUA"
    data-category="General"
    data-category-id="DIC_kwDOJI1XUM4CU1nn"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
</script>

      </div>
  
</div>
</div>
        <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Mobx%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">1. Mobx介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8A%BF"><span class="toc-number">1.1.</span> <span class="toc-text">优势</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E5%8C%BA%E8%AF%84%E4%BB%B7"><span class="toc-number">1.2.</span> <span class="toc-text">社区评价</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">2.</span> <span class="toc-text">2. 配置开发环境</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">3. 基础使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%88%9D%E5%A7%8B%E5%8C%96mobx"><span class="toc-number">3.1.</span> <span class="toc-text">1. 初始化mobx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-React%E4%BD%BF%E7%94%A8store"><span class="toc-number">3.2.</span> <span class="toc-text">2. React使用store</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%EF%BC%88%E8%A1%8D%E7%94%9F%E7%8A%B6%E6%80%81%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">4. 计算属性（衍生状态）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E5%BC%82%E6%AD%A5%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">5. 异步数据处理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">6.</span> <span class="toc-text">6. 模块化</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%A4%9A%E7%BB%84%E4%BB%B6%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE"><span class="toc-number">7.</span> <span class="toc-text">7. 多组件共享数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-Todos%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B"><span class="toc-number">8.</span> <span class="toc-text">8. Todos综合案例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">8.1.</span> <span class="toc-text">1. 开发环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Mobx%E5%92%8CReact%E7%9A%84%E8%81%8C%E8%B4%A3%E5%88%92%E5%88%86"><span class="toc-number">8.2.</span> <span class="toc-text">2. Mobx和React的职责划分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="toc-number">8.3.</span> <span class="toc-text">3. 列表渲染</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%8D%95%E9%80%89%E5%AE%9E%E7%8E%B0"><span class="toc-number">8.4.</span> <span class="toc-text">4. 单选实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%88%A0%E9%99%A4%E5%8A%9F%E8%83%BD"><span class="toc-number">8.5.</span> <span class="toc-text">5. 删除功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%85%A8%E9%80%89%E5%8A%9F%E8%83%BD"><span class="toc-number">8.6.</span> <span class="toc-text">6. 全选功能</span></a></li></ol></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
    </div>
    <div id="nexmoe-search-space">
	<div class="search-container">
		<div class="search-header">
			<div class="search-input-container">
				<input
					class="search-input"
					type="text"
					placeholder="搜索"
					oninput="sinput();"
				/>
			</div>
			<a class="search-close" onclick="sclose();">×</a>
		</div>
		<div class="search-body"></div>
	</div>
</div>

    
    
</body>

</html>
